<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Caminando con Cristo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
        body { font-family: 'Lexend', sans-serif; margin: 0; background-color: #f3f4f6; display: flex; justify-content: center; }
        #app-viewport { width: 100%; max-width: 414px; height: 100vh; position: relative; background: white; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 0 40px rgba(0,0,0,0.1); }
        .view { width: 100%; height: 100%; display: flex; flex-direction: column; position: absolute; top: 0; left: 0; background: white; z-index: 10; }
        .scroll-area { flex: 1; overflow-y: auto; padding-bottom: 90px; }
        .hidden { display: none !important; }
        
        /* Nav Inferior Fijo */
        nav { position: absolute; bottom: 0; width: 100%; height: 75px; background: white; border-top: 1px solid #f0f0f0; display: flex; justify-content: space-around; align-items: center; z-index: 50; }
        nav button { display: flex; flex-direction: column; align-items: center; gap: 2px; color: #94a3b8; border: none; background: none; cursor: pointer; }
        nav button.active { color: #2563eb; }
        nav b { font-size: 10px; text-transform: uppercase; }

        input, select { border: 1px solid #e5e7eb !important; border-radius: 16px !important; padding: 14px !important; outline: none; width: 100%; }
        .role-card { border: 2px solid #f3f4f6; border-radius: 20px; padding: 16px; text-align: center; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .role-card.active { border-color: #2563eb; background: #eff6ff; color: #2563eb; }
    </style>
</head>
<body>

    <div id="app-viewport">
        
        <section id="view-auth" class="view p-8 flex flex-col items-center justify-center space-y-6">
            <div class="text-center mb-4">
                <span class="material-symbols-outlined text-blue-600 text-7xl">auto_stories</span>
                <h1 class="text-3xl font-bold italic mt-2">Caminando con Cristo</h1>
            </div>

            <div class="w-full space-y-3">
                <button onclick="loginSocial('Google')" class="w-full flex items-center justify-center gap-3 border border-gray-200 py-4 rounded-2xl font-bold text-sm">
                    <img src="https://www.google.com/favicon.ico" class="w-5"> Continuar con Google
                </button>
                <button onclick="loginSocial('Apple')" class="w-full flex items-center justify-center gap-3 bg-black text-white py-4 rounded-2xl font-bold text-sm">
                    <span class="material-symbols-outlined">apple</span> Continuar con Apple
                </button>
                
                <div class="flex items-center gap-3 py-2">
                    <div class="flex-1 h-[1px] bg-gray-100"></div>
                    <span class="text-[10px] text-gray-300 font-bold uppercase">o usa tu correo</span>
                    <div class="flex-1 h-[1px] bg-gray-100"></div>
                </div>

                <input type="email" id="auth-email" placeholder="Correo electrónico">
                <button onclick="iniciar()" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold shadow-lg">Ingresar</button>
            </div>
        </section>

        <section id="view-setup" class="view hidden p-8">
            <h2 class="text-2xl font-bold">Crea tu Perfil</h2>
            <p class="text-gray-400 text-sm mb-6">Solo te tomará un minuto.</p>
            
            <div class="scroll-area space-y-4">
                <input type="text" id="setup-name" placeholder="Nombre completo">
                <input type="tel" id="setup-phone" placeholder="WhatsApp">
                
                <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest pl-1 mt-4">¿Cuál es tu rol?</p>
                <div class="grid grid-cols-2 gap-3">
                    <div onclick="selectRole('alumno')" id="card-alumno" class="role-card">Alumno</div>
                    <div onclick="selectRole('maestro')" id="card-maestro" class="role-card">Maestro</div>
                </div>

                <div id="extra-alumno" class="hidden">
                    <select id="setup-maestro">
                        <option value="">Selecciona tu maestro...</option>
                        <option value="Pastor Juan">Pastor Juan Carlos</option>
                        <option value="Maestra Elena">Maestra Elena</option>
                    </select>
                </div>

                <div id="extra-maestro" class="hidden">
                    <input type="password" id="setup-code" placeholder="Código de Maestro (1234)">
                </div>

                <button onclick="finalizarRegistro()" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold shadow-xl mt-6">Comenzar</button>
            </div>
        </section>

        <section id="view-home" class="view hidden">
            <header class="p-6 border-b bg-white flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div id="avatar" class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold"></div>
                    <div>
                        <p id="user-name" class="font-bold text-sm leading-none"></p>
                        <p id="user-role" class="text-[9px] text-gray-400 font-bold uppercase mt-1"></p>
                    </div>
                </div>
                <button onclick="cerrarSesion()" class="text-gray-300"><span class="material-symbols-outlined">logout</span></button>
            </header>
            <div id="books-list" class="scroll-area p-6 space-y-4"></div>
        </section>

        <nav id="bottom-nav" class="hidden">
            <button onclick="cambiarPantalla('view-home')" id="nav-home" class="active">
                <span class="material-symbols-outlined">auto_stories</span><b>Libros</b>
            </button>
            <button onclick="alert('Próximamente Comunidad')" id="nav-comunidad">
                <span class="material-symbols-outlined">groups</span><b>Comunidad</b>
            </button>
            <button onclick="cambiarPantalla('view-profile')" id="nav-perfil">
                <span class="material-symbols-outlined">person</span><b>Perfil</b>
            </button>
        </nav>

    </div>

    <script>
        // --- LOGICA DE ESTADO ---
        let usuario = JSON.parse(localStorage.getItem('sesion_cristo')) || null;
        let rolSeleccionado = "";

        // Al cargar, verificar si hay sesión
        window.onload = () => {
            if (usuario) {
                mostrarAppPrincipal();
            } else {
                cambiarPantalla('view-auth');
            }
        };

        // --- FUNCIONES DE NAVEGACIÓN ---
        function cambiarPantalla(id) {
            document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        // --- LOGICA DE REGISTRO ---
        function iniciar() {
            const email = document.getElementById('auth-email').value;
            if(!email.includes('@')) return alert("Ingresa un correo válido");
            cambiarPantalla('view-setup');
        }

        function loginSocial(red) {
            // Simulación rápida: mandamos al setup
            cambiarPantalla('view-setup');
        }

        function selectRole(rol) {
            rolSeleccionado = rol;
            document.getElementById('card-alumno').className = "role-card " + (rol === 'alumno' ? 'active' : '');
            document.getElementById('card-maestro').className = "role-card " + (rol === 'maestro' ? 'active' : '');
            
            document.getElementById('extra-alumno').classList.toggle('hidden', rol !== 'alumno');
            document.getElementById('extra-maestro').classList.toggle('hidden', rol !== 'maestro');
        }

        function finalizarRegistro() {
            const nombre = document.getElementById('setup-name').value;
            const tel = document.getElementById('setup-phone').value;
            
            if(!nombre || !tel || !rolSeleccionado) return alert("Por favor completa los campos");

            if(rolSeleccionado === 'maestro' && document.getElementById('setup-code').value !== '1234') {
                return alert("Código de maestro incorrecto");
            }

            usuario = {
                nombre: nombre,
                whatsapp: tel,
                rol: rolSeleccionado,
                email: document.getElementById('auth-email').value
            };

            localStorage.setItem('sesion_cristo', JSON.stringify(usuario));
            mostrarAppPrincipal();
        }

        // --- APP INTERNA ---
        function mostrarAppPrincipal() {
            cambiarPantalla('view-home');
            document.getElementById('bottom-nav').classList.remove('hidden');
            
            // Actualizar textos
            document.getElementById('user-name').innerText = usuario.nombre;
            document.getElementById('user-role').innerText = usuario.rol;
            document.getElementById('avatar').innerText = usuario.nombre[0].toUpperCase();

            renderLibros();
        }

        function renderLibros() {
            const libros = [
                { id: 1, titulo: 'Libro 1: Fundamentos', color: 'bg-blue-600' },
                { id: 2, titulo: 'Libro 2: Oración', color: 'bg-gray-300' }
            ];
            const container = document.getElementById('books-list');
            container.innerHTML = libros.map(l => `
                <div class="bg-white p-5 rounded-3xl border border-gray-100 flex items-center gap-4 shadow-sm">
                    <div class="w-12 h-12 ${l.color} rounded-2xl flex items-center justify-center text-white font-bold">${l.id}</div>
                    <p class="font-bold text-gray-800 flex-1">${l.titulo}</p>
                    <span class="material-symbols-outlined text-gray-300">chevron_right</span>
                </div>
            `).join('');
        }

        function cerrarSesion() {
            localStorage.removeItem('sesion_cristo');
            location.reload();
        }
    </script>
</body>
</html>
